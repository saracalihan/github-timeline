const defaultVariables={grey:"#ddd",lightBlack:"#a8a8a8",softBlack:"rgb(29, 28, 28)",hoverBacground:"#f7f7f7",heigth:"600px",width:"500px",headerFontSize:"28px",avatarSize:"80px",mainFontSize:"16px"};let variables=defaultVariables;const updateStyles=function(e){return{main:`\n            display: flex;\n            flex-direction: column;\n            max-width: ${e.width};\n            min-width: 210px;\n            max-height: ${e.heigth};\n            padding: 10px 0 10px 0;\n            border: 1px solid ${e.grey};\n            border-radius: 15px;\n            background-color: white;\n            font-family: Arial, Helvetica, sans-serif;\n          `,header:`\n            position: relative;\n            box-sizing: border-box;\n            padding-left: 15px;\n            z-index: 3;\n            border-bottom: .5px solid ${e.grey};\n            color: ${e.softBlack};\n            font-size: ${e.headerFontSize};\n          `,headerSmall:`\n            color: ${e.lightBlack};\n            font-size: 14px;\n          `,footer:`\n            padding: 5px 0;\n            border-top: .5px solid ${e.grey};\n            font-size: ${e.mainFontSize};\n            text-align: center;\n            font-size: 14px;\n            font-weight: bold;\n          `,events:"\n            overflow-y: auto;\n            list-style: none;\n            padding: 0;\n            margin: 0;\n          ",event:`\n            display: flex;\n            flex-direction: row;\n            justify-content: space-between;\n            padding: 8px;\n            font-size: ${e.mainFontSize};\n            border-top: 1px solid ${e.grey};\n            transition: .2s background-color;\n            cursor: pointer;\n          `,eventDetail:`\n            width: 60%;\n            display: flex;\n            flex-direction: column;\n            justify-content: space-around;\n            font-size: ${e.mainFontSize};\n          `,eventName:`\n            color: ${e.softBlack};\n            text-decoration: none;\n            font-weight: bold;\n          `,date:"\n            margin: 0;\n            color: #505050;\n            font-size: 12px;\n          ",avatar:`\n            width: ${e.avatarSize};\n            border: .8px solid ${e.grey};\n            border-radius: 50%;\n          `}};let styles=updateStyles(variables);const timelines=document.getElementsByClassName("github-timeline"),getUserInfo=function(e){return new Promise((function(n,t){try{fetch("https://api.github.com/users/"+e).then((e=>e.json())).then((e=>{e.url?n({type:"user",isSuccess:!0,data:e}):n({type:"user",isSuccess:!1,data:e})}))}catch(e){t(e)}}))},getUserEvents=function(e){return new Promise((function(n,t){try{fetch("https://api.github.com/users/"+e+"/events").then((e=>e.json())).then((e=>{Array.isArray(e)&&e.length>0?n({type:"events",isSuccess:!0,data:e}):n({type:"events",isSuccess:!1,data:e})}))}catch(e){t(e)}}))},createTimeline=function(e,n){e.innerHTML=`\n        <div style="${styles.header}">\n          Github Events <small style="${styles.headerSmall}">by \n          <a\n            style="color: rgb(61, 61, 255);font-size: 14px;"\n            href="https://github.com/${n.login}"\n            target="_blank"\n          >\n            @${n.login}\n          </a>\n        </small>\n        </div>\n        <ul style="${styles.events}">\n          \x3c!-- Events inject here --\x3e\n        </ul>\n        `},injectEventComponents=function(e,n,t){let a=e.childNodes[3];t||(a.innerHTML='<p style="text-align:center; color: grey;">User not found an event</p>');for(let e of t){let t={year:"numeric",month:"long",day:"numeric"},i=new Date(e.created_at).toLocaleDateString("en-US",t),r=e.repo.name.split("/")[0].toLowerCase(),o=e.org?e.org.avatar_url:e.actor.avatar_url,s=document.createElement("li");s.style=styles.event,s.innerHTML=`\n            <div style="display: flex;flex-direction: column;align-content: center;justify-content: center;">\n              <a \n                href="https://github.com/${r}"\n                title="${r}"\n              >\n                <img \n                  src="${o}"\n                  alt="User Avatar"\n                  style="${styles.avatar}"\n                >\n              </a>\n            </div>\n            <div style="${styles.eventDetail}">\n                <a \n                  href="https://github.com/${r}"\n                  style="margin:0; ${styles.eventName}"\n                >\n                  ${r}\n                </a>\n              <p style="margin:0">\n                ${n.name} ${e.payload.action?e.payload.action:""} ${e.type.replace("Event","").split(/(?=[A-Z])/).join(" ").toLowerCase()}  \n              </p>\n              <a\n                href="https://github.com/${e.repo.name}"\n                style="margin:0;text-decoration: none; color: ${variables.softBlack}"\n              >\n                to: ${e.repo.name}\n              </a>\n            </div>\n            <div style="display: flex;flex-direction: column;align-items: flex-end;justify-content: space-between">\n              <p style="${styles.date}">\n                ${i}\n              <p>\n            </div>\n          `,s.addEventListener("mouseover",(function(){s.style.backgroundColor=variables.hoverBacground})),s.addEventListener("mouseout",(function(){s.style.backgroundColor="white"})),s.addEventListener("click",(function(){window.open(`https://github.com/${e.repo.name}`,"_blank")})),a.appendChild(s)}let i=document.createElement("div");i.style=styles.footer,i.innerHTML='\n            Coded by <a href="https://github.com/saracalihan/" target="_blank">@saracalihan</a>',a.appendChild(i)},rander=function(e,n,t){n?(styles=updateStyles(variables),createTimeline(e,n),injectEventComponents(e,n,t)):errorUserNotFound(e)},resizeTimeline=function(e,n,t){var a=!1;e.clientWidth<330?(variables.headerFontSize="18px",variables.mainFontSize="12px",variables.avatarSize="30px",a=!0):e.clientWidth<425?(variables.headerFontSize="24px",variables.mainFontSize="14px",variables.avatarSize="50px",a=!0):e.clientWidth<500&&(variables=Object.create(defaultVariables),a=!0),a&&rander(e,n,t)},errorUserNotFound=function(e){e.innerHTML=`<p style="text-align: center;margin: 5px;">'<strong>${e.dataset.username}</strong>' user not found!</p>`};for(let e of timelines){e.style=styles.main;let n={},t=[];Promise.all([getUserInfo(e.dataset.username),getUserEvents(e.dataset.username)]).then((function(a){n=a.find((e=>"user"===e.type&&e.isSuccess))||null,t=a.find((e=>"events"===e.type&&e.isSuccess))||null,n=n?n.data:null,t=t?t.data:null,rander(e,n,t),window.addEventListener("resize",(function(){resizeTimeline(e,n,t)})),resizeTimeline(e,n,t)}))}
